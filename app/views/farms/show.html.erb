<div class="bg-primary p-5 text-white">
  <div class="container">
    <div class="row no-gutters flex-md-row">
      <div class="col-8">
        <h3 class="display-4"><%= @farm.name %></h3>
        <p class="lead my-3"><%= @farm.sector %></p>
      </div>
      <div class="col-4">
        <div class="sc-gauge">
          <div class="sc-background">
            <div class="sc-percentage" style="transform: rotate(<%= @farm.total * 1.8 %>deg); transition: all 1.5s ease;"></div>
            <div class="sc-mask"></div>
            <span class="sc-value"><%= @farm.total %></span>
          </div>
        </div>
      </div>

      <div class="col-8">
            <p class="card-text mb-4"><%= @farm.description %></p>
            <div class="d-flex">
              <%= render 'claps' %>
              <%= render 'add_to_list' %>
            </div>
      </div>
      <div id="carouselExampleControls" class="carousel slide col-4" data-ride="carousel">
        <div class="carousel-inner">
          <% if @farm.photos.attached? %>
            <% @farm.photos.each_with_index do |photo, index| %>
              <div class="carousel-item <%= 'active' if index == 0 %>">
                <%= cl_image_tag photo.key, height: 200, width:300, style: "width: 100%", crop: :fill, class: 'rounded-sm' %>
              </div>
            <% end %>
          <% else %>
            <%= image_tag "https://images.unsplash.com/photo-1444858291040-58f756a3bdd6?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1530&q=80", height: 200, width:300, style: "width: 100%", crop: :fill, class: 'rounded-sm' %>
          <% end %>
        </div>
        <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
          </a>
            <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
          </a>
      </div>
    </div>
  </div>
</div>

<div class="container p-5">
  <ul class="nav nav-tabs" id="myTab" role="tablist">
    <li class="nav-item">
      <a class="nav-link active" id="globale-tab" data-toggle="tab" href="#globale" role="tab" aria-controls="globale" aria-selected="true">
        <div class="pt-3 px-3 text-center">
          <div class="h1 m-0">
            <%= @farm.average("Global") %>
          </div>
          <div class="text-muted">Globale</div>
        </div>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" id="eco-tab" data-toggle="tab" href="#eco" role="tab" aria-controls="eco" aria-selected="false">
        <div class="pt-3 px-3 text-center">
          <div class="h1 m-0">
            <%= @farm.average("Économique") %>
          </div>
          <div class="text-muted">Economique</div>
        </div>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" id="social-tab" data-toggle="tab" href="#social" role="tab" aria-controls="social" aria-selected="false">
        <div class="pt-3 px-3 text-center">
          <div class="h1 m-0">
            <%= @farm.average("Social") %>
          </div>
          <div class="text-muted">Social</div>
        </div>
      </a>
    </li>
    <li class="nav-item">
      <a class="nav-link" id="env-tab" data-toggle="tab" href="#env" role="tab" aria-controls="env" aria-selected="false">
        <div class="pt-3 px-3 text-center">
          <div class="h1 m-0">
            <%= @farm.average("Environnemental") %>
          </div>
          <div class="text-muted">Environnementale</div>
        </div>
      </a>
    </li>
  </ul>
  <div class="tab-content border border-top-0 rounded-bottom shadow-sm" id="myTabContent">
    <div class="tab-pane fade show active" id="globale" role="tabpanel" aria-labelledby="globale-tab">
        <%= render 'rating', zone: "Global" %>
    </div>
    <div class="tab-pane fade" id="eco" role="tabpanel" aria-labelledby="eco-tab">
      <%= render 'rating', zone: "Économique" %>
    </div>
    <div class="tab-pane fade" id="social" role="tabpanel" aria-labelledby="social-tab">
      <%= render 'rating', zone: "Social" %>
    </div>
    <div class="tab-pane fade" id="env" role="tabpanel" aria-labelledby="env-tab">
      <%= render 'rating', zone: "Environnemental" %>
    </div>
  </div>
</div>
